import pytest

from deepteam.vulnerabilities import CustomVulnerability


class TestCustomVulnerability:

    def test_custom_vulnerability_initialize(self):
        custom_vulnerability = CustomVulnerability(
            criteria="Criteria",
            name="Name",
            custom_prompt="Custom prompt",
            types=["type1", "type2"],
        )
        assert custom_vulnerability.criteria == "Criteria"
        assert custom_vulnerability.name == "Name"
        assert custom_vulnerability.custom_prompt == "Custom prompt"
        assert custom_vulnerability.metric is not None
        assert sorted(
            type.value for type in custom_vulnerability.types
        ) == sorted(["type1", "type2"])
